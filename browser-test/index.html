<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kairos Browser Compatibility Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #5e72e4 0%, #825ee4 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .browser-info {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .browser-info h2 {
            color: #495057;
            margin-bottom: 15px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            border-left: 4px solid #5e72e4;
        }
        
        .info-item strong {
            color: #495057;
            display: block;
            margin-bottom: 5px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .test-section {
            padding: 30px;
        }
        
        .test-category {
            margin-bottom: 30px;
        }
        
        .test-category h3 {
            color: #495057;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .test-grid {
            display: grid;
            gap: 10px;
        }
        
        .test-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .test-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .test-status {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 14px;
        }
        
        .test-status.pass {
            background: #28a745;
        }
        
        .test-status.fail {
            background: #dc3545;
        }
        
        .test-status.pending {
            background: #ffc107;
        }
        
        .test-name {
            flex: 1;
            font-weight: 500;
        }
        
        .test-result {
            color: #6c757d;
            font-size: 0.9em;
            font-family: 'Courier New', monospace;
        }
        
        .summary {
            background: linear-gradient(135deg, #5e72e4 0%, #825ee4 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .summary-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            display: block;
        }
        
        .stat-label {
            opacity: 0.9;
            text-transform: uppercase;
            font-size: 0.9em;
            letter-spacing: 1px;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .progress-fill {
            height: 100%;
            background: #28a745;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .error-details {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 15px;
            margin-top: 10px;
            color: #856404;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #6c757d;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #5e72e4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üï∞Ô∏è Kairos Browser Compatibility Test</h1>
            <p>Comprehensive browser compatibility testing for Kairos date/time library</p>
        </header>
        
        <div class="browser-info">
            <h2>Browser Information</h2>
            <div class="info-grid" id="browserInfo">
                <div class="loading">
                    <div class="spinner"></div>
                    Detecting browser...
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <div id="testResults">
                <div class="loading">
                    <div class="spinner"></div>
                    Loading Kairos library...
                </div>
            </div>
        </div>
        
        <div class="summary" id="summary" style="display: none;">
            <h2>Test Summary</h2>
            <div class="summary-stats">
                <div class="stat">
                    <span class="stat-value" id="passCount">0</span>
                    <span class="stat-label">Passed</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="failCount">0</span>
                    <span class="stat-label">Failed</span>
                </div>
                <div class="stat">
                    <span class="stat-value" id="totalCount">0</span>
                    <span class="stat-label">Total</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>
        </div>
    </div>
    
    <!-- Load Kairos UMD build -->
    <script src="/dist/kairos.umd.min.js"></script>
    
    <script>
        // Browser detection
        function detectBrowser() {
            const ua = navigator.userAgent;
            let browserName = 'Unknown';
            let browserVersion = 'Unknown';
            
            if (ua.indexOf('Firefox') > -1) {
                browserName = 'Firefox';
                browserVersion = ua.match(/Firefox\/([0-9.]+)/)?.[1] || 'Unknown';
            } else if (ua.indexOf('Chrome') > -1 && ua.indexOf('Edg') === -1) {
                browserName = 'Chrome';
                browserVersion = ua.match(/Chrome\/([0-9.]+)/)?.[1] || 'Unknown';
            } else if (ua.indexOf('Safari') > -1 && ua.indexOf('Chrome') === -1) {
                browserName = 'Safari';
                browserVersion = ua.match(/Version\/([0-9.]+)/)?.[1] || 'Unknown';
            } else if (ua.indexOf('Edg') > -1) {
                browserName = 'Edge';
                browserVersion = ua.match(/Edg\/([0-9.]+)/)?.[1] || 'Unknown';
            }
            
            return {
                name: browserName,
                version: browserVersion,
                userAgent: ua,
                platform: navigator.platform,
                language: navigator.language,
                onLine: navigator.onLine,
                cookieEnabled: navigator.cookieEnabled,
                screenResolution: `${screen.width}x${screen.height}`,
                timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
            };
        }
        
        // Display browser info
        function displayBrowserInfo() {
            const info = detectBrowser();
            const browserInfoEl = document.getElementById('browserInfo');
            
            browserInfoEl.innerHTML = `
                <div class="info-item">
                    <strong>Browser</strong>
                    ${info.name} ${info.version}
                </div>
                <div class="info-item">
                    <strong>Platform</strong>
                    ${info.platform}
                </div>
                <div class="info-item">
                    <strong>Language</strong>
                    ${info.language}
                </div>
                <div class="info-item">
                    <strong>Screen</strong>
                    ${info.screenResolution}
                </div>
                <div class="info-item">
                    <strong>Timezone</strong>
                    ${info.timezone}
                </div>
                <div class="info-item">
                    <strong>Online</strong>
                    ${info.onLine ? 'Yes' : 'No'}
                </div>
            `;
        }
        
        // Test runner
        class TestRunner {
            constructor() {
                this.tests = [];
                this.results = [];
            }
            
            addTest(category, name, fn) {
                this.tests.push({ category, name, fn });
            }
            
            async runTests() {
                const resultsEl = document.getElementById('testResults');
                const categories = {};
                
                for (const test of this.tests) {
                    if (!categories[test.category]) {
                        categories[test.category] = [];
                    }
                    
                    try {
                        const result = await test.fn();
                        categories[test.category].push({
                            name: test.name,
                            passed: true,
                            result: result
                        });
                        this.results.push({ ...test, passed: true, result });
                    } catch (error) {
                        categories[test.category].push({
                            name: test.name,
                            passed: false,
                            error: error.message
                        });
                        this.results.push({ ...test, passed: false, error: error.message });
                    }
                }
                
                // Display results
                let html = '';
                for (const [category, tests] of Object.entries(categories)) {
                    html += `
                        <div class="test-category">
                            <h3>${category}</h3>
                            <div class="test-grid">
                    `;
                    
                    for (const test of tests) {
                        const statusClass = test.passed ? 'pass' : 'fail';
                        const statusIcon = test.passed ? '‚úì' : '‚úó';
                        const resultText = test.passed ? 
                            (test.result !== undefined ? test.result : 'Passed') : 
                            test.error;
                        
                        html += `
                            <div class="test-item">
                                <div class="test-status ${statusClass}">${statusIcon}</div>
                                <div class="test-name">${test.name}</div>
                                <div class="test-result">${resultText}</div>
                            </div>
                        `;
                    }
                    
                    html += `
                            </div>
                        </div>
                    `;
                }
                
                resultsEl.innerHTML = html;
                this.showSummary();
            }
            
            showSummary() {
                const passed = this.results.filter(r => r.passed).length;
                const failed = this.results.filter(r => !r.passed).length;
                const total = this.results.length;
                const percentage = Math.round((passed / total) * 100);
                
                document.getElementById('passCount').textContent = passed;
                document.getElementById('failCount').textContent = failed;
                document.getElementById('totalCount').textContent = total;
                document.getElementById('progressBar').style.width = percentage + '%';
                document.getElementById('progressBar').textContent = percentage + '%';
                
                if (failed > 0) {
                    document.getElementById('progressBar').style.background = '#ffc107';
                }
                
                document.getElementById('summary').style.display = 'block';
            }
        }
        
        // Load Kairos and run tests
        async function loadAndTest() {
            displayBrowserInfo();
            
            try {
                // Check if Kairos is loaded
                if (typeof window.kairos === 'undefined') {
                    throw new Error('Kairos library not loaded. Make sure the UMD build is available.');
                }
                
                // Use the global kairos object (named exports)
                const kairosLib = window.kairos.default || window.kairos;
                
                const runner = new TestRunner();
                
                // Core functionality tests
                runner.addTest('Core', 'Create instance', () => {
                    const instance = kairosLib();
                    return instance ? 'Created' : 'Failed';
                });
                
                runner.addTest('Core', 'Parse date string', () => {
                    const instance = kairosLib('2024-01-15');
                    return instance.format('YYYY-MM-DD');
                });
                
                runner.addTest('Core', 'Current timestamp', () => {
                    const instance = kairosLib();
                    return instance.valueOf() > 0;
                });
                
                // Date manipulation tests
                runner.addTest('Manipulation', 'Add days', () => {
                    const instance = kairosLib('2024-01-15');
                    const result = instance.add(5, 'days');
                    return result ? 'Success' : 'Failed';
                });
                
                runner.addTest('Manipulation', 'Subtract days', () => {
                    const instance = kairosLib('2024-01-15');
                    const result = instance.subtract(3, 'days');
                    return result ? 'Success' : 'Failed';
                });
                
                // Formatting tests
                runner.addTest('Formatting', 'Default format', () => {
                    const instance = kairosLib('2024-01-15');
                    return instance.format();
                });
                
                runner.addTest('Formatting', 'Custom format', () => {
                    const instance = kairosLib('2024-01-15');
                    return instance.format('YYYY-MM-DD');
                });
                
                // Comparison tests
                runner.addTest('Comparison', 'Is before', () => {
                    const date1 = kairosLib('2024-01-15');
                    const date2 = kairosLib('2024-02-15');
                    return date1.isBefore(date2);
                });
                
                runner.addTest('Comparison', 'Is after', () => {
                    const date1 = kairosLib('2024-02-15');
                    const date2 = kairosLib('2024-01-15');
                    return date1.isAfter(date2);
                });
                
                // Browser API tests
                runner.addTest('Browser APIs', 'Date object', () => {
                    return typeof Date !== 'undefined';
                });
                
                runner.addTest('Browser APIs', 'Intl.DateTimeFormat', () => {
                    return typeof Intl !== 'undefined' && typeof Intl.DateTimeFormat !== 'undefined';
                });
                
                runner.addTest('Browser APIs', 'Performance.now', () => {
                    return typeof performance !== 'undefined' && typeof performance.now === 'function';
                });
                
                runner.addTest('Browser APIs', 'Array methods', () => {
                    return Array.prototype.map && Array.prototype.filter && Array.prototype.reduce;
                });
                
                runner.addTest('Browser APIs', 'Object methods', () => {
                    return Object.keys && Object.values && Object.entries;
                });
                
                runner.addTest('Browser APIs', 'Promise support', () => {
                    return typeof Promise !== 'undefined';
                });
                
                runner.addTest('Browser APIs', 'Symbol support', () => {
                    return typeof Symbol !== 'undefined';
                });
                
                runner.addTest('Browser APIs', 'Map/Set support', () => {
                    return typeof Map !== 'undefined' && typeof Set !== 'undefined';
                });
                
                // Run all tests
                await runner.runTests();
                
            } catch (error) {
                document.getElementById('testResults').innerHTML = `
                    <div class="error-details">
                        <h3>Error Loading Kairos</h3>
                        <p>${error.message}</p>
                        <p>Make sure to build the library first: <code>npm run build</code></p>
                    </div>
                `;
            }
        }
        
        // Start tests when page loads
        window.addEventListener('DOMContentLoaded', loadAndTest);
    </script>
</body>
</html>